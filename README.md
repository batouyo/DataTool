# 多功能生理数据采集与分析工具

这是一个集成了多摄像头录制和血氧仪数据分析功能的工具，专为无接触式生理信息提取模型的数据采集和分析设计。

## 功能特点

### 多摄像头录制功能
- 自动检测和扫描系统摄像头设备
- 同时预览多个摄像头画面
- 自定义录制参数（帧率、录制时长）
- 对象命名与自动文件夹创建
- 详细的录制日志（时间戳、帧数、帧率等）
- 实时显示北京时间

![image-20250701044239893](https://gitee.com/ccYep/upload-image/raw/master/20250701054423242.png)

### 血氧仪数据分析功能

- 解析HL7格式的血氧仪数据文件
- 识别并提取多种生理信号：
  - 心电图(ECG)波形
  - 脉搏血氧饱和度(SpO2)波形
  - 胸阻抗波形
  - 其他波形数据
- 波形图可视化展示
- 数据表格查看
- 参数信息展示
- 导出Excel数据文件
- 保存波形图像

![image-20250701044303993](https://gitee.com/ccYep/upload-image/raw/master/20250701054929457.png)

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 启动程序

```bash
python main.py
```

### 多摄像头录制使用方法

1. 点击"多摄像头录制"选项卡
2. 点击"扫描摄像头设备"按钮检测可用摄像头
3. 从下拉菜单选择摄像头，点击"添加摄像头"将其添加到预览区域
4. 设置输出目录、录制时长和帧率（录制时长设置为“0”时则无限制）
5. 点击"开始录制"按钮，在对象设置弹窗中输入被测对象名称或编号
6. 录制完成后，视频和日志将保存在指定目录的对象文件夹中
7. 点击"停止录制"可随时手动结束录制

### 血氧仪数据分析使用方法

1. 点击"血氧仪数据分析"选项卡
2. 点击"浏览..."按钮选择血氧仪数据文件（.txt文件）
3. 点击"分析数据"按钮开始分析
4. 使用下拉菜单选择要查看的信号类型
5. 在标签页之间切换，查看波形图、数据表格和参数信息
6. 点击"导出Excel"按钮将数据导出为Excel文件
7. 点击"保存图像"按钮将当前显示的波形图保存为图像文件

## 输出文件

### 多摄像头录制输出
- 视频文件：`{对象名称}/camera_{摄像头ID}.avi`
- 日志文件：`{对象名称}/camera_{摄像头ID}_log.txt`
- JSON日志：`{对象名称}/recording_info.json`

### 血氧仪数据分析输出
- Excel数据文件：`{原文件名}_data.xlsx`
- 波形图像文件：用户自定义保存路径和名称
